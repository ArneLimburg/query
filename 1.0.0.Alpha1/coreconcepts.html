<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory">Chapter 2. Core Concepts</title><link rel="stylesheet" href="css/cambridge.css" type="text/css"/><meta xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" name="generator" content="DocBook XSL Stylesheets V1.74.0"/><link rel="home" href="index.html" title="CDI Query Module"/><link rel="up" href="index.html" title="CDI Query Module"/><link rel="prev" href="installation.html" title="Chapter 1. Installation"/></head><body><p id="title"><a href="http://www.ctp-consulting.com" class="site_href"><strong>Cambridge Technology Partners</strong></a><a href="http://www.ctp-consulting.com" class="doc_href"><strong>Community Documentation</strong></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="installation.html"><strong>Prev</strong></a></li><li class="next"/></ul><div class="chapter" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="coreconcepts"/>Chapter 2. Core Concepts</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="coreconcepts.html#daos">2.1. DAOs</a></span></dt><dd><dl><dt><span class="section"><a href="coreconcepts.html#daos-entity-dao">2.1.1. The EntityDao interface</a></span></dt></dl></dd></dl></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="daos"/>2.1. DAOs</h2></div></div></div><p>
            With the CDI Query Module, it is possible to make a DAO out of basically any abstract class or interface (using
            a concrete class will work too, but you won't be able to use most of the CDI Query features).
            All that is required is to mark the type as such with a simple annotation:
        </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Dao</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_type">Person</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">abstract</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">PersonDao</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Dao</span><span class="java_separator">(</span><span class="java_type">Person</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">PersonDao</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span></pre><p>
            The @Dao annotation tells CDI Query that this is a DAO for the Person entity. Any method defined on the DAO
            will be processed by the framework. The annotation does not require to set the entity class (we'll see later why)
            but if there are just plain classes or interfaces this is the only way to tell the framework what entity
            the DAO relates to. In order to simplify this, CDI Query provides several base types.
        </p><div class="section" lang="en-US"><div class="titlepage"><div><div><h3 class="title"><a id="daos-entity-dao"/>2.1.1. The EntityDao interface</h3></div></div></div><p>
                Although mainly intended to hold complex query logic, working with both a DAO and an entity manager in
                the service layer might unnecessarily clutter code. In order to avoid this for the most common cases, 
                CDI Query provides base types which can be used to replace the entity manager.
            </p><p>
                The top base type is the EntityDao interface, providing common methods used with an entity manager. 
                The following code shows the most important methods of the interface:
            </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">public</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">interface</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">EntityDao</span><!-- <br/> --><span class="java_operator">&lt;</span><!-- <br/> --><span class="java_plain">E</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;PK</span><!-- <br/> --><span class="java_operator">&gt;</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;E&nbsp;save</span><span class="java_separator">(</span><span class="java_plain">E&nbsp;entity</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;E&nbsp;saveAndFlush</span><span class="java_separator">(</span><span class="java_plain">E&nbsp;entity</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;remove</span><span class="java_separator">(</span><span class="java_plain">E&nbsp;entity</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;E&nbsp;findBy</span><span class="java_separator">(</span><span class="java_plain">PK&nbsp;primaryKey</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_plain">E</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;findAll</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Long</span><span class="java_plain">&nbsp;count</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre><p>
                Your concrete DAO can then either implement or extend this basic interface. For our basic person DAO,
                this might look like the following:
            </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Dao</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">PersonDao</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">EntityDao</span><span class="java_operator">&lt;</span><span class="java_type">Person</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Long</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Person</span><span class="java_plain">&nbsp;findBySsn</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;ssn</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></pre><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>Tip</h2><p>
                    Annotations on interfaces do not inherit. If the EntityDao interface is extended by another interface adding
                    some more common methods, it is not possible to simply add the annotation there. It needs to go on each
                    concrete DAO. The same is not true if a base class is introduced, as we see in the next chapter.
                </p></div></div></div></div><ul class="docnav"><li class="previous"><a accesskey="p" href="installation.html"><strong>Prev</strong>Chapter 1. Installation</a></li><li class="up"><a accesskey="u" href="#"><strong>Top of page</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Front page</strong></a></li></ul></body></html>