<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory">Chapter 3. Query Method Expressions</title><link rel="stylesheet" href="css/cambridge.css" type="text/css"/><meta xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" name="generator" content="DocBook XSL Stylesheets V1.74.0"/><link rel="home" href="index.html" title="CDI Query Module"/><link rel="up" href="index.html" title="CDI Query Module"/><link rel="prev" href="coreconcepts.html" title="Chapter 2. Core Concepts"/><link rel="next" href="annotations.html" title="Chapter 4. Query Annotations"/></head><body><p id="title"><a href="http://www.ctp-consulting.com" class="site_href"><strong>Cambridge Technology Partners</strong></a><a href="http://www.ctp-consulting.com" class="doc_href"><strong>Community Documentation</strong></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="coreconcepts.html"><strong>Prev</strong></a></li><li class="next"><a accesskey="n" href="annotations.html"><strong>Next</strong></a></li></ul><div class="chapter" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="methodexpressions"/>Chapter 3. Query Method Expressions</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="methodexpressions.html#methodexpressions-usage">3.1. Using method expressions</a></span></dt><dt><span class="section"><a href="methodexpressions.html#methodexpressions-ordering">3.2. Query Ordering</a></span></dt><dt><span class="section"><a href="methodexpressions.html#methodexpressions-options">3.3. Query Options</a></span></dt></dl></div><p>
        Good naming is a difficult aspects in software engineering. A good method name usually makes comments unnecessary
        and states exactly what the method does. And with method expressions, the method name is actually the implementation!
    </p><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="methodexpressions-usage"/>3.1. Using method expressions</h2></div></div></div><p>
            Let's start by looking at an example:
        </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Entity</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Id</span><span class="java_plain">&nbsp;@</span><span class="java_type">GeneratedValue</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Long</span><span class="java_plain">&nbsp;id</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Integer</span><span class="java_plain">&nbsp;age</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Gender</span><span class="java_plain">&nbsp;gender</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">PersonDao</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">EntityDao</span><span class="java_operator">&lt;</span><span class="java_type">Person</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Long</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Person</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;findByNameLikeAndAgeBetweenAndGender</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;minAge</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;maxAge</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Gender</span><span class="java_plain">&nbsp;gender</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span></pre><p>
            Looking at the method name, this can easily be read as query all Persons which have a name like the
            given name parameter, their age is between a min and a max age and having a specific gender. The CDI Query
            module can translate method names following a given format and directly generate the query implementation
            out of it (in EBNF-like form):
        </p><pre class="programlisting">(Entity|List&lt;Entity&gt;) findBy(Property[Comparator]){Operator Property [Comparator]}</pre><p>
            Or in more concrete words:
            </p><div class="itemizedlist"><ul><li>The query method must either return an entity or a list of entities</li><li>It must start with the findBy keyword</li><li>
                    Followed by a property of the DAO entity and an optional comparator (we'll define this later). The property
                    will be used in the query together with the comparator. Note that the number of arguments passed to the 
                    method depend on the comparator.
                </li><li>
                    You can add more blocks of property-comparator which have to be concatenated by a boolean operator. This
                    is either an <code class="literal">And</code> or <code class="literal">Or</code></li></ul></div><p>
            Other assumptions taken by the expression evaluator:
            </p><div class="itemizedlist"><ul><li>
                    The property name starts lower cased while the property in the expression has an upper cases first character.
                </li></ul></div><p>
        </p><p>
            Following comparators are currently supported to be used in method expressions:
            </p><div class="informaltable"><table border="1"><colgroup><col/><col/><col/></colgroup><thead><tr><th>Name</th><th># of Arguments</th><th>Description</th></tr></thead><tbody><tr><td><code class="literal">Equal</code></td><td><code class="literal">1</code></td><td>Property must be equal to argument value. If the operator is omitted in the expression, this is assumed as default.</td></tr><tr><td><code class="literal">NotEqual</code></td><td><code class="literal">1</code></td><td>Property must be not equal to argument value.</td></tr><tr><td><code class="literal">Like</code></td><td><code class="literal">1</code></td><td>Property must be like the argument value. Use the %-wildcard in the argument.</td></tr><tr><td><code class="literal">GreaterThan</code></td><td><code class="literal">1</code></td><td>Property must be greater than argument value.</td></tr><tr><td><code class="literal">GreaterThanEquals</code></td><td><code class="literal">1</code></td><td>Property must be greater than or equal to argument value.</td></tr><tr><td><code class="literal">LessThan</code></td><td><code class="literal">1</code></td><td>Property must be less than argument value.</td></tr><tr><td><code class="literal">LessThanEquals</code></td><td><code class="literal">1</code></td><td>Property must be less than or equal to argument value.</td></tr><tr><td><code class="literal">Between</code></td><td><code class="literal">2</code></td><td>Property must be between the two argument values.</td></tr><tr><td><code class="literal">IsNull</code></td><td><code class="literal">0</code></td><td>Property must be null.</td></tr><tr><td><code class="literal">IsNotNull</code></td><td><code class="literal">0</code></td><td>Property must be non-null.</td></tr></tbody></table></div><p>
        </p></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="methodexpressions-ordering"/>3.2. Query Ordering</h2></div></div></div><p>
            Beside comparators it's also possible to sort queries by using the <code class="literal">OrderBy</code> keyword, followed
            by the attribute name and the direction (<code class="literal">Asc</code> or <code class="literal">Desc</code>).
        </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">public</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">interface</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">PersonDao</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">extends</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">EntityDao</span><!-- <br/> --><span class="java_operator">&lt;</span><!-- <br/> --><span class="java_type">Person</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Long</span><!-- <br/> --><span class="java_operator">&gt;</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Person</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;findByLastNameLikeOrderByAgeAscLastNameDesc</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;lastName</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span></pre></div><div class="section" lang="en-US"><div class="titlepage"><div><div><h2 class="title"><a id="methodexpressions-options"/>3.3. Query Options</h2></div></div></div><p>
            CDI Query supports query options on method expressions. If you want to page a query, you can change the first
            result as well as the maximum number of results returned:
        </p><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">public</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">interface</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">PersonDao</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">extends</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">EntityDao</span><!-- <br/> --><span class="java_operator">&lt;</span><!-- <br/> --><span class="java_type">Person</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Long</span><!-- <br/> --><span class="java_operator">&gt;</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Person</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;findByNameLike</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">,</span><span class="java_plain">&nbsp;@</span><span class="java_type">FirstResult</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;start</span><span class="java_separator">,</span><span class="java_plain">&nbsp;@</span><span class="java_type">MaxResults</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;pageSize</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_separator">}</span><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span></pre></div></div><ul class="docnav"><li class="previous"><a accesskey="p" href="coreconcepts.html"><strong>Prev</strong>Chapter 2. Core Concepts</a></li><li class="up"><a accesskey="u" href="#"><strong>Top of page</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>Front page</strong></a></li><li class="next"><a accesskey="n" href="annotations.html"><strong>Next</strong>Chapter 4. Query Annotations</a></li></ul></body></html>